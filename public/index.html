<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>마헤 – 알 카드 레이스</title>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
          sans-serif;
        background: url('bg-main.png') center center / cover no-repeat fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
      .hidden {
        display: none;
      }

      /* 프로필 카드 */
      #profile-screen {
        width: 360px;
        padding: 24px;
        border-radius: 20px;
        background: #000;
        border: 1px solid rgba(255, 255, 255, 0.12);
        color: #fff;
        box-shadow: 0 22px 45px rgba(0, 0, 0, 0.95),
          inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      #profile-screen h1 {
        font-size: 22px;
        font-weight: 700;
        margin: 0 0 8px;
        letter-spacing: 0.06em;
      }
      #profile-screen label {
        font-size: 14px;
        display: block;
        margin-top: 16px;
        margin-bottom: 8px;
      }
      #nickname-input,
      #color-select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        font-size: 14px;
        background: #050505;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
      }
      #nickname-input::placeholder {
        color: #777;
      }
      #nickname-input:focus,
      #color-select:focus {
        border-color: #d4af37;
        box-shadow: 0 0 8px rgba(212, 175, 55, 0.75);
        outline: none;
      }
      .avatar-dropzone {
        width: 100%;
        aspect-ratio: 1 / 1;
        border-radius: 14px;
        background: #050505;
        border: 1px dashed rgba(212, 175, 55, 0.75);
        color: #f5f5f5;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 14px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.2s ease;
      }
      .avatar-dropzone:hover {
        border-color: #ffe08a;
        box-shadow: 0 0 14px rgba(250, 204, 21, 0.95);
      }
      .avatar-dropzone img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      #enter-game-btn {
        margin-top: 22px;
        width: 100%;
        padding: 12px;
        border-radius: 999px;
        border: 1px solid #d4af37;
        background: linear-gradient(135deg, #3a0202, #6d0505, #900b0b);
        color: #fff;
        font-size: 16px;
        font-weight: 800;
        letter-spacing: 0.08em;
        cursor: pointer;
        transition: 0.15s ease;
      }
      #enter-game-btn:hover {
        background: linear-gradient(135deg, #b30000, #e30606, #ff1a1a);
        box-shadow: 0 0 16px rgba(255, 36, 36, 0.9),
          0 0 22px rgba(212, 175, 55, 0.9);
      }
      #enter-game-btn:active {
        transform: translateY(1px) scale(0.98);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.7);
      }
      #enter-game-btn:disabled {
        opacity: 0.5;
        background: #333;
        border-color: rgba(255, 255, 255, 0.2);
        box-shadow: none;
        cursor: default;
      }

      /* 공통 버튼 효과 */
      button {
        transition: transform 0.06s ease, box-shadow 0.06s ease,
          filter 0.06s ease;
      }
      button:hover {
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
        filter: brightness(1.03);
      }
      button:active {
        transform: translateY(1px) scale(0.97);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        filter: brightness(0.96);
      }

      /* 게임 화면 */
      #game-screen {
        width: 100%;
        max-width: 1100px;
        min-height: 90vh;
        background: radial-gradient(circle at 20% 0%, rgba(34, 197, 94, 0.18), transparent 55%),
          radial-gradient(
            circle at 80% 100%,
            rgba(45, 212, 191, 0.18),
            transparent 55%
          ),
          linear-gradient(145deg, #022c22, #052e16 45%, #022c22 100%);
        border-radius: 18px;
        border: 2px solid rgba(255, 255, 255, 0.4);
        padding: 16px 24px 24px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        box-shadow: 0 18px 35px rgba(0, 0, 0, 0.75),
          inset 0 1px 0 rgba(255, 255, 255, 0.06);
      }

      #header-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      #game-title {
        font-size: 22px;
        font-weight: 800;
        letter-spacing: 0.2em;
        color: #fefce8;
      }

      #card-info {
        font-size: 14px;
        color: #e5e7eb;
        text-align: right;
      }

      #main-row {
        display: grid;
        grid-template-columns: 2fr 1.2fr;
        gap: 12px;
        margin-top: 4px;
      }

      /* 왼쪽: 보드 */
      #board-panel {
        background: rgba(15, 23, 42, 0.96);
        border-radius: 14px;
        padding: 10px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        color: #e5e7eb;
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      #board {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 6px;
      }

      .board-cell {
        background: #020617;
        border-radius: 10px;
        padding: 4px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        min-height: 42px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }
      .board-cell.cell-start {
        border-color: #facc15;
        box-shadow: 0 0 8px rgba(250, 204, 21, 0.6);
      }
      .cell-label {
        font-size: 11px;
        color: #cbd5f5;
      }
      .cell-tokens {
        display: flex;
        flex-wrap: wrap;
        gap: 2px;
        margin-top: 2px;
      }
      .token {
        width: 14px;
        height: 14px;
        border-radius: 50%;
        border: 1px solid rgba(15, 23, 42, 0.9);
      }

      /* 오른쪽: 정보/조작 패널 */
      #side-panel {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      #turn-panel {
        background: #f9fafb;
        border-radius: 14px;
        padding: 8px 10px;
        border: 1px solid #e5e7eb;
      }
      #turn-indicator {
        font-size: 15px;
        font-weight: 700;
        margin-bottom: 4px;
      }

      #action-buttons {
        display: flex;
        gap: 6px;
        margin-bottom: 6px;
      }
      #roll-btn {
        flex: 1;
        border-radius: 999px;
        border: 1px solid #4c1d95;
        background: linear-gradient(
          135deg,
          #170d2c 0%,
          #21194b 30%,
          #4338ca 60%,
          #7c3aed 100%
        );
        color: #f9fafb;
        font-weight: 700;
        letter-spacing: 0.04em;
        cursor: pointer;
      }
      #roll-btn:disabled {
        opacity: 0.5;
        background: #1e293b;
      }
      #stop-btn {
        flex: 1;
        border-radius: 999px;
        border: 1px solid #15803d;
        background: linear-gradient(
          135deg,
          #064e3b 0%,
          #15803d 40%,
          #22c55e 100%
        );
        color: #ecfdf5;
        font-weight: 700;
        letter-spacing: 0.04em;
        cursor: pointer;
      }
      #stop-btn:disabled {
        opacity: 0.5;
        background: #15803d;
      }

      #dice-row {
        display: flex;
        gap: 4px;
        margin-bottom: 4px;
      }
      .die {
        width: 28px;
        height: 28px;
        border-radius: 6px;
        border: 1px solid #9ca3af;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        background: radial-gradient(
          circle at 30% 25%,
          #ffffff 0%,
          #e5e7eb 40%,
          #cbd5e1 100%
        );
        box-shadow: 0 1px 0 #ffffff, 0 3px 4px rgba(0, 0, 0, 0.45);
      }

      #dice-sum-info {
        font-size: 13px;
        color: #374151;
      }

      #start-game-btn {
        width: 100%;
        margin-top: 6px;
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid #7f1d1d;
        background: linear-gradient(
          135deg,
          #2b0a0a,
          #5b0f0f,
          #9f0e0e,
          #d61f1f,
          #ff4d4d
        );
        color: #fff5f5;
        font-weight: 700;
        letter-spacing: 0.04em;
        cursor: pointer;
      }
      #start-game-btn:disabled {
        opacity: 0.5;
        background: #4b5563;
      }

      #player-list-panel {
        background: #f9fafb;
        border-radius: 14px;
        padding: 6px 8px;
        border: 1px solid #e5e7eb;
        font-size: 12px;
      }
      .player-row {
        margin: 2px 0;
      }

      #me-panel {
        background: rgba(255, 255, 255, 0.94);
        border-radius: 14px;
        padding: 6px 10px;
        border: 1px solid rgba(250, 204, 21, 0.7);
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .avatar-circle {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid #e5e7eb;
      }
      .avatar-circle img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      #my-name {
        font-weight: 700;
      }
      #my-score {
        font-size: 14px;
        font-weight: 700;
        color: #b45309;
      }
      #my-egg-info {
        font-size: 11px;
        color: #4b5563;
      }

      #log-area {
        margin-top: 6px;
        background: rgba(15, 23, 42, 0.96);
        border-radius: 10px;
        padding: 6px 8px;
        border: 1px solid rgba(148, 163, 184, 0.7);
        color: #e5e7eb;
        font-size: 11px;
        max-height: 120px;
        overflow-y: auto;
      }

      /* 게임 종료 패널 */
      #game-over-panel {
        margin-top: 8px;
      }
      .game-over-card {
        border-radius: 12px;
        border: 1px solid #fbbf24;
        padding: 10px 12px;
        background: #fffbeb;
        font-size: 13px;
      }
      .game-over-title {
        font-weight: 700;
        margin-bottom: 4px;
      }
      .game-over-row {
        margin: 2px 0;
      }
      .game-over-row.winner {
        color: #d97706;
        font-weight: 700;
      }
      #restart-btn {
        margin-top: 6px;
        padding: 5px 10px;
        border-radius: 999px;
        border: 1px solid #9ca3af;
        background: #e5e7eb;
        font-size: 12px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <!-- 프로필 화면 -->
    <div id="profile-screen">
      <h1>마헤 입장</h1>
      <input
        id="nickname-input"
        type="text"
        placeholder="닉네임을 입력하세요"
      />

      <label>프로필 사진</label>
      <div id="avatar-drop" class="avatar-dropzone">
        <span id="avatar-drop-text">클릭해서 업로드</span>
        <input
          id="avatar-input"
          type="file"
          accept="image/*"
          style="display: none"
        />
      </div>

      <label>말 색깔</label>
      <select id="color-select">
        <option value="red">빨강</option>
        <option value="green">초록</option>
        <option value="blue">파랑</option>
        <option value="yellow">노랑</option>
      </select>

      <button id="enter-game-btn">게임 입장</button>
    </div>

    <!-- 게임 화면 -->
    <div id="game-screen" class="hidden">
      <div id="header-row">
        <div id="game-title">MAHÉ</div>
        <div id="card-info">
          <div>공개된 알 카드: <span id="faceup-card">-</span></div>
          <div>남은 알 카드: <span id="remaining-eggs">0</span>장</div>
        </div>
      </div>

      <div id="main-row">
        <!-- 왼쪽: 보드 -->
        <div id="board-panel">
          <div style="margin-bottom: 4px; font-size: 13px">
            <strong>트랙</strong> – 0번 칸을 지나면 알 카드를 얻어요.
          </div>
          <div id="board"></div>
        </div>

        <!-- 오른쪽: 조작/정보 -->
        <div id="side-panel">
          <div id="turn-panel">
            <div id="turn-indicator">대기 중…</div>
            <div id="action-buttons">
              <button id="roll-btn" disabled>주사위 굴리기</button>
              <button id="stop-btn" disabled>멈추고 이동</button>
            </div>
            <div id="dice-row"></div>
            <div id="dice-sum-info">
              합계: <span id="dice-sum">0</span> (7을 넘기면 버스트!)
            </div>
            <button id="start-game-btn" disabled>게임 시작</button>
          </div>

          <div id="player-list-panel">
            <div style="font-weight: 700; margin-bottom: 4px">플레이어</div>
            <div id="player-list"></div>
          </div>

          <div id="me-panel">
            <div class="avatar-circle">
              <img id="my-avatar" src="default-avatar.png" alt="" />
            </div>
            <div>
              <div id="my-name">나</div>
              <div id="my-score">0점</div>
              <div id="my-egg-info">알 합계 0, 장수 0장, 보너스 0</div>
            </div>
          </div>

          <div id="log-area"></div>

          <div id="game-over-panel" class="hidden">
            <div class="game-over-card">
              <div id="game-over-title" class="game-over-title">게임 종료</div>
              <div id="game-over-list" class="game-over-list"></div>
              <button id="restart-btn">같은 인원으로 다시 하기</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 필요하면 효과음 파일을 넣어 사용 -->
    <audio id="bgm" src="" loop></audio>
    <audio id="sfx-roll" src=""></audio>
    <audio id="sfx-bust" src=""></audio>
    <audio id="sfx-egg" src=""></audio>
    <audio id="sfx-win" src=""></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
  </body>
</html>
